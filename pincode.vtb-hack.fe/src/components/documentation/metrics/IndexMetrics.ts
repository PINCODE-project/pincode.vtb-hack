import type { MetricSection } from "./types";

/**
 * Данные метрик Индексов для анализа настроек БД
 */
export const indexMetrics: MetricSection = {
	title: "Метрики Индексов",
	items: [
		{
			title: "Неиспользуемые индексы",
			metric: "averageScans и maxSize",
			threshold: "Различные пороги по размеру",
			level: "high",
			description: "Индексы, которые редко или совсем не используются, но занимают место на диске.",
			recommendations: [
				"Критический уровень (> 100 MB): Удалить индекс с использованием CONCURRENTLY",
				"Средний уровень (10-100 MB): Рассмотреть возможность удаления",
				"Низкий уровень (≤ 10 MB): Можно оставить, если размер не критичен",
			],
		},
		{
			title: "Неэффективные индексы",
			metric: "efficiency в процентах",
			threshold: "< 30% эффективности",
			level: "high",
			description:
				"Индексы с низкой эффективностью, которые читают много данных для возврата малого количества результатов.",
			recommendations: [
				"< 10%: Пересмотреть необходимость существования индекса",
				"10-30%: Добавить более селективные колонки в индекс",
				"> 30%: Оптимизировать порядок колонок в индексе",
			],
		},
		{
			title: "Быстрорастущие индексы",
			metric: "growthPercentage",
			threshold: "> 50% роста",
			level: "critical",
			description: "Индексы, которые быстро увеличиваются в размере, что может указывать на фрагментацию.",
			recommendations: [
				"Выполнить REINDEX INDEX CONCURRENTLY",
				"Оптимизировать fillfactor для таблиц с частыми обновлениями",
				"Рассмотреть partitioning таблицы",
			],
		},
		{
			title: "Интенсивно используемые индексы",
			metric: "averageScans и efficiency",
			threshold: "Высокое использование с низкой эффективностью",
			level: "medium",
			description: "Индексы с высокой нагрузкой, которые нуждаются в оптимизации.",
			recommendations: [
				"Срочно оптимизировать структуру индекса для низкой эффективности",
				"Продолжать мониторить для хорошей эффективности",
				"Обеспечить регулярное обслуживание индекса",
			],
		},
	],
};

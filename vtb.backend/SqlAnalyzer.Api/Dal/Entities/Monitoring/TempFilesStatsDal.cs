using SqlAnalyzer.Api.Dal.Entities.Base;

namespace SqlAnalyzer.Api.Dal.Entities.Monitoring;

/// <summary>
/// Статистика использования временных файлов PostgreSQL
/// Мониторинг временных файлов помогает выявить проблемы с производительностью и настройкой БД
/// </summary>
public class TempFilesStatsDal : EntityBase, IEntityCreatedAt
{
    /// <summary>
    /// Количество созданных временных файлов
    /// Временные файлы создаются когда операция не помещается в оперативной памяти (work_mem)
    /// Высокое значение может указывать на:
    /// - Недостаточный размер work_mem
    /// - Большие операции сортировки, хэширования или агрегации
    /// - Неоптимальные запросы, требующие временного хранения данных
    /// </summary>
    public long TempFiles { get; set; }
    
    /// <summary>
    /// Общий объем данных во временных файлах (в байтах)
    /// Показывает сколько данных было выгружено на диск из-за нехватки оперативной памяти
    /// Большие значения могут значительно снижать производительность из-за дискового I/O
    /// Рекомендуется мониторить этот показатель для выявления "тяжелых" запросов
    /// </summary>
    public long TempBytes { get; set; }
    
    /// <summary>
    /// Дата и время сбора статистики
    /// Позволяет отслеживать пиковые нагрузки и коррелировать с выполнением конкретных запросов
    /// </summary>
    public DateTime CreateAt { get; set; }
    
    /// <summary>
    /// Идентификатор подключения к базе данных
    /// Связывает статистику временных файлов с конкретным экземпляром БД
    /// Полезно для кластерных окружений с несколькими базами данных
    /// </summary>
    public Guid DbConnectionId { get; set; }
}